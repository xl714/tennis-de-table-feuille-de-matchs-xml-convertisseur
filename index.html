<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Résumer une feuille de match XML d'une rencontre par équipe</title>
    <style>
      .hide {
        display: none;
      }
      body {
        font-family: Arial, sans-serif;
        padding: 10px;
        background-color: #f8f9fa;
        overflow-x: hidden;
      }

      h1 {
        color: #333;
        text-align: center;
      }

      p {
        color: #555;
        text-align: left;
      }
      .result {
        margin-bottom: 10px;
        color: #555;
        font-size: 0.9em;
      }

      .result-constainer legend {
        padding: 0 15px 0 15px;
        font-size: 1.1em;
      }

      .load-file-container {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin-top: 20px;
      }

      .load-local-file-container,
      .load-test-file-container {
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      label {
        font-size: 1.2em;
        color: #444;
        margin-bottom: 10px;
      }

      .load-input {
        min-width: 400px;
        padding: 15px 30px;
        font-size: 1.2em;
        font-weight: bold;
        color: #fff;
        background-color: #007bff;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        transition: background-color 0.3s, transform 0.2s;
        text-align: center;
      }

      .disclaimer {
        font-size: x-small;
        text-align: right;
      }

      button:hover {
        background-color: #0056b3;
      }

      button:active {
        transform: scale(0.98);
      }

      .options {
        margin-top: 20px;
        padding: 20px;
        text-align: left;
      }
      .options legend {
        padding: 0 10px 0 10px;
      }

      .result-constainer {
        border: 1px solid silver;
        padding: 10px;
        margin-bottom: 10px;
      }

      .result-title {
        font-weight: bold;
        font-size: 1.1em;
        margin: 5px 0 5px 0;
      }

      #xml-test {
        text-align: left;
        color: #333;
        border: 1px dashed #ccc;
        padding: 20px;
        border-radius: 5px;
        background-color: #fff;
        margin-top: 20px;
        font-size: 0.8em;
      }

      /******************
      *** POPIN COMMON ***
      ******************/

      #popin-container {
        position: fixed;
        margin: 0;
        padding: 0;
        z-index: 1000;
        top: 0px;
        left: 0px;
        width: 100vw;
        height: 100vh;
        background-color: rgba(59, 59, 59, 0.95);
      }
      #popin {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        min-width: 40vw;
        max-width: 80vw;
        min-height: 20vh;
        max-height: 80vh;
        border: 1px solid rgba(207, 226, 255, 1);
        background-color: rgba(245, 250, 255, 1);
        padding: 5px;
        display: flex;
        flex-direction: column;
        border-radius: 5px;
      }
      #popin * {
        font-family: Verdana, Geneva, sans-serif;
      }
      #popin-header {
        display: flex;
        width: 100%;
        font-size: 1.1em;
        font-weight: 600;
      }
      #popin-title {
        display: block;
        text-align: center;
        width: calc(100% - 30px);
        padding: 5px;
        border: 1px solid rgba(207, 226, 255, 1);
        background-color: rgba(207, 226, 255, 0.1);
        margin-right: 5px;
        border-radius: 3px;
      }
      #popin-close {
        display: block;
        width: 30px;
        padding: 5px;
        margin-left: auto;
        text-align: center;
        border: 1px solid rgba(207, 226, 255, 1);
        background-color: rgba(207, 226, 255, 0.7);
        border-radius: 3px;
      }
      #popin-close:hover {
        cursor: pointer;
        padding: 5px;
      }
      #popin-content {
        padding: 5px;
        margin-top: 5px;
        border: 1px solid rgba(207, 226, 255, 1);
        background-color: rgba(207, 226, 255, 0.1);
        overflow-y: scroll;
        overflow-wrap: break-word;
        flex: auto;
        border-radius: 3px;
      }

      /******************
      *** POPIN CUSTOM ***/

      #popin-select-team-container {
        width: 800px;
        text-align: center; /* Centre tout le contenu */
        padding: 20px;
        font-family: Arial, sans-serif;
      }

      .select-team-form {
        display: flex; /* Affiche les boutons côte à côte */
        justify-content: center; /* Centre les boutons horizontalement */
        gap: 20px; /* Ajoute un espacement entre les boutons */
      }

      .select-team-btn {
        width: 45%;
        font-size: 18px; /* Texte plus grand */
        padding: 10px 20px; /* Agrandit les boutons */
        background-color: #007bff; /* Couleur de fond */
        color: white; /* Texte blanc */
        border: none; /* Supprime les bordures par défaut */
        border-radius: 5px; /* Coins arrondis */
        cursor: pointer; /* Change le curseur au survol */
        transition: background-color 0.3s ease; /* Animation fluide */
      }

      .select-team-btn:hover {
        background-color: #0056b3; /* Change la couleur au survol */
      }

      @media only screen and (max-device-width: 900px) {
        body {
          width: 95vw;
          position: relative;
          left: -2.5vw;
        }
        h1 {
          width: 100%;
          font-size: 1.3em;
        }
        .load-file-container {
          display: block;
          text-align: center;
        }
        .load-file-container > div {
          width: 100%;
          display: block;
          text-align: center;
        }
        .load-input {
          display: inline-block;
          width: 85% !important;
          max-width: 85% !important;
          font-size: 1em !important;
          min-width: 85% !important;
        }
        .load-input:first-of-type {
          margin-bottom: 10px;
        }
        #xml-test {
          width: 90%;
          overflow-x: auto;
          overflow-y: visible;
          font-size: 0.7em;
        }
        #popin {
          max-width: 90vw;
        }
        #popin-content {
          overflow: hidden;
        }
        .select-team-form {
          display: block;
          width: 80vw;
          gap: unset;
          text-align: center;
        }
        .select-team-btn {
          width: 90%;
          font-size: 1em;
          padding: 8px 10px;
        }
        .select-team-btn:first-of-type {
          margin-bottom: 8px;
        }
        .options {
          text-align: left;
          width: 69vw;
          border: 1px solid gray;
        }
        .result-constainer {
          border: 1px solid silver;
          padding: 5px;
          margin-bottom: 5px;
        }
        /* .result-constainer legend {
          margin-left: 10px;
        } */
      }
    </style>
  </head>
  <body>
    <h1 id="title">
      Résumer une feuille de match XML d'une rencontre par équipe
    </h1>
    <p>
      Dans le logicial GIRPE, à la fin d'une rencontre par équipe. Envoyez-vous
      par email la feuille de match au format XML.
    </p>
    <p>Ensuite téléchargez le fichier sur votre ordinateur.</p>
    <p class="disclaimer">
      Si vous appercevez une erreur envoyez moi un email à
      xavier.langlois.2022+tt@gmail.com
    </p>

    <div class="load-file-container">
      <div class="load-local-file-container">
        <!--label for="xml-file-input" id="load-xml-file-input-btn" class="load-input">Chargez votre fichier XML</label-->
        <button
          onclick="document.getElementById('xml-file-input').click();"
          id="load-xml-file-input-btn"
          class="load-input"
        >
          Chargez votre fichier XML
        </button>
      </div>
      <div class="load-xml-test-container">
        <button id="load-xml-test-btn" class="load-input">
          Charger un fichier XML exemple
        </button>
      </div>
    </div>
    <input type="file" id="xml-file-input" accept=".xml" hidden />
    <div id="output" style="margin-top: 20px; white-space: pre-wrap"></div>
    <div id="xml-test" style="margin-top: 20px; white-space: pre-wrap">
      <root>Ici sera afficher le XML chargé</root>
    </div>

    <script type="module">
      var encounter = null;

      /*
       ****
       *******
       ************
       ********************
       ********************************
       ********************** Match ********************
       ****************************************************/

      export class Match {
        constructor(team, player, match, otherPlayersDict) {
          this.initTeamAndPlayer(team, player);
          this.initOtherPlayer(match, otherPlayersDict);
          this.diffPoints = this.calculatePointsDifference();
          this.win = this.determineWin(match);
          this.tags = this.assignTagsByDiff();
          this.extractSets(match);
          this.winLossPoints = this.getWinLossPoints();
          this.teamLetterWin = match["pointsa"] === "2" ? "a" : "x";

          console.log("Match after extractSets");
          console.log("  this.team", this.team);
          console.log("  this.player", this.player);
          console.log("  this.win", this.win);
          console.log("  this.diffPoints", this.diffPoints);
          console.log("  this.winLossPoints", this.winLossPoints);
          console.log("  this.sets", this.sets);
          console.log("  this.setNumber", this.setNumber);
          console.log("  this.setWinNumber", this.setWinNumber);
        }

        getWinLossPoints() {
          const list = this.winLossPointList();
          this.diffPoints = this.playerPoints - this.otherPlayerPoints;
          this.winLossKey = this.win ? "victoire" : "defaite";
          // Victoires Normales : victoire contre un joueur ayant autant ou moins de points que vous.
          // Victoire Anormales : victoire contre un joueur ayant plus de points que vous.
          // Défaites normales : défaite contre un joueur ayant autant ou plus de points que vous.
          // Défaites anormales : défaite contre un joueur ayant moins de points que vous.
          if (this.win) {
            this.normalAnormalKey =
              this.diffPoints >= 0 ? "normale" : "anormale";
          } else {
            this.normalAnormalKey =
              this.diffPoints <= 0 ? "normale" : "anormale";
          }
          this.winLossPointskey = `${this.winLossKey}_${this.normalAnormalKey}`;
          this.diffPointsAbs = Math.abs(this.diffPoints);
          const entry = list.find(
            (item) =>
              this.diffPointsAbs >= item.ecart_de_points_min &&
              this.diffPointsAbs <= item.ecart_de_points_max
          );
          const winLossPoints = entry ? entry[this.winLossPointskey] : 0;
          if (winLossPoints === 0) {
            console.warn(
              "Aucun winLossPointskey n'est trouvé, cela ne devrait pas arriver."
            );
          }
          return winLossPoints;
        }

        initTeamAndPlayer(team, player) {
          this.team = JSON.parse(JSON.stringify(team));
          this.player = JSON.parse(JSON.stringify(player));
          delete this.player["matchs"];

          Object.keys(this.team).forEach((key) => {
            if (key.includes("joueur")) {
              delete this.team[key];
            }
          });
          this.teamLetter = this.team["teamLetter"];
          this.playerLetter = this.player["letter"];
          this.playerPoints = parseInt(
            this.player["pointsclassementsjoueur"],
            10
          );
          console.log("initTeamAndPlayer this.team", this.team);
          console.log("initTeamAndPlayer this.player ", this.player);
          console.log("initTeamAndPlayer this.teamLetter ", this.teamLetter);
          console.log(
            "initTeamAndPlayer this.playerLetter ",
            this.playerLetter
          );
        }

        initOtherPlayer(match, otherPlayersDict) {
          console.log("initOtherPlayer otherPlayersDict", otherPlayersDict);
          const onePLayerLetter = Object.values(otherPlayersDict)[0].letter;
          const keyOtherPlayer = "abcd".includes(onePLayerLetter)
            ? "lettrea"
            : "lettrex";
          console.log("initOtherPlayer keyOtherPlayer", keyOtherPlayer);
          console.log("initOtherPlayer match", match);
          console.log(
            "initOtherPlayer match[keyOtherPlayer]",
            match[keyOtherPlayer]
          );
          this.otherPlayerLetter = match[keyOtherPlayer].toLowerCase();
          console.log(
            "initOtherPlayer this.otherPlayerLetter",
            this.otherPlayerLetter
          );
          this.otherPlayer = otherPlayersDict[this.otherPlayerLetter];
          console.log("initOtherPlayer this.otherPlayer", this.otherPlayer);
          this.otherPlayerPoints = parseInt(
            this.otherPlayer["pointsclassementsjoueur"],
            10
          );
        }

        calculatePointsDifference() {
          return this.playerPoints - this.otherPlayerPoints;
        }

        determineWin(match) {
          this.teamLetterWin = match["pointsa"] === "2" ? "a" : "x";
          return this.teamLetter === this.teamLetterWin;
        }

        assignTagsByDiff() {
          return this.getTagsByDiff(this.diffPoints, this.win);
        }

        extractSets(match) {
          this.sets = [];
          this.setNumber = 0;
          this.setWinNumber = 0;
          for (let n = 1; n <= 7; n++) {
            const value = match[`manche${n}`] || false;

            if (value && typeof value != "object" && value != NaN) {
              console.log(
                "  set value",
                value,
                typeof value,
                Math.abs(parseInt(value, 10))
              );
              console.log(this.teamLetter, value[0] === "-");
              this.setNumber++;
              const minus = value[0] === "-";
              const win = this.teamLetter === "a" && !minus;
              this.sets.push({
                score: Math.abs(parseInt(value, 10)),
                minus,
                win,
              });
              if (win) this.setWinNumber++;
            }
          }
          if (this.setNumber === 5) {
            this.tags.push("match tendu");
          }
        }

        getSummary() {
          const result = this.win ? "victoire" : "défaite";
          const setStr = this.setWinNumber > 1 ? "sets gagnés" : "set gagné";
          // return `vs ${this.otherPlayer["prenomjoueur"][0]}. ${
          //   this.otherPlayer["nomjoueur"]
          // }: ${result} avec ${this.setWinNumber} ${setStr} (${this.tags.join(
          //   ","
          // )})`;
          const hashtags = this.tags.map((str) => {
            return `#${str
              .toLowerCase()
              .split(" ") // Split the string into words
              .map((word) => word.charAt(0).toUpperCase() + word.slice(1)) // Capitalize each word
              .join("")}`; // Join the words without spaces
          });
          this.winLossPoints =
            this.winLossPoints > 0
              ? `+${this.winLossPoints}`
              : this.winLossPoints;
          return `VS ${this.otherPlayer["prenomjoueur"]} ${
            this.otherPlayer["pointsclassementsjoueur"]
          }: ${result} avec ${this.setWinNumber} ${setStr} (${
            this.winLossPoints
          } points) (${hashtags.join(" ")})`;
        }

        getTagsByDiff(diff, win) {
          const tags = [];
          if (win) {
            if (diff > 0) {
              tags.push(
                diff < 100
                  ? "victoire normale"
                  : diff < 200
                  ? "victoire évidente"
                  : "victoire inévitable"
              );
            } else {
              tags.push(
                "anormal",
                diff > -100 ? "belle victoire" : "performance incroyable"
              );
            }
          } else {
            if (diff < 0) {
              tags.push(
                diff > -100
                  ? "défaite normale"
                  : diff < -200
                  ? "défaite inévitable"
                  : "défaite évidente"
              );
            } else {
              tags.push(
                "anormal",
                diff < 100 ? "triste défaite" : "contre performance incroyable"
              );
            }
          }
          return tags;
        }

        winLossPointList() {
          return [
            {
              ecart_de_points_min: 0,
              ecart_de_points_max: 24,
              victoire_normale: 6,
              defaite_normale: -5,
              victoire_anormale: 6,
              defaite_anormale: -5,
            },
            {
              ecart_de_points_min: 25,
              ecart_de_points_max: 49,
              victoire_normale: 5.5,
              defaite_normale: -4.5,
              victoire_anormale: 7,
              defaite_anormale: -6,
            },
            {
              ecart_de_points_min: 50,
              ecart_de_points_max: 99,
              victoire_normale: 5,
              defaite_normale: -4,
              victoire_anormale: 8,
              defaite_anormale: -7,
            },
            {
              ecart_de_points_min: 100,
              ecart_de_points_max: 149,
              victoire_normale: 4,
              defaite_normale: -3,
              victoire_anormale: 10,
              defaite_anormale: -8,
            },
            {
              ecart_de_points_min: 150,
              ecart_de_points_max: 199,
              victoire_normale: 3,
              defaite_normale: -2,
              victoire_anormale: 13,
              defaite_anormale: -10,
            },
            {
              ecart_de_points_min: 200,
              ecart_de_points_max: 299,
              victoire_normale: 2,
              defaite_normale: -1,
              victoire_anormale: 17,
              defaite_anormale: -12.5,
            },
            {
              ecart_de_points_min: 300,
              ecart_de_points_max: 399,
              victoire_normale: 1,
              defaite_normale: -0.5,
              victoire_anormale: 22,
              defaite_anormale: -16,
            },
            {
              ecart_de_points_min: 400,
              ecart_de_points_max: 499,
              victoire_normale: 0.5,
              defaite_normale: 0,
              victoire_anormale: 28,
              defaite_anormale: -20,
            },
            {
              ecart_de_points_min: 500,
              ecart_de_points_max: 9999,
              victoire_normale: 0,
              defaite_normale: 0,
              victoire_anormale: 40,
              defaite_anormale: -29,
            },
          ];
        }
      }

      /*
       ****
       *******
       ************
       ********************
       ********************************
       ********************** Encounter ********************
       ****************************************************/

      export class Encounter {
        constructor(xmlStr) {
          this.xmlStr = xmlStr;
          this.sheetObject = this.processXML(xmlStr);
          this.recto = this.sheetObject.liste.recto;
          this.equipea = this.recto.equipea;
          this.equipex = this.recto.equipex;
          this.playersCount = this.getPlayersCount();
          this.equipea["teamLetter"] = "a";
          this.equipex["teamLetter"] = "x";
          this.metas = this.recto.typefeuille;
          this.matchs = this.recto.parties;
          this.usePlayerCat = false;
          console.log("this.metas", this.metas);
          console.log("this.matchs", this.matchs);
        }

        getPlayersCount() {
          return Object.keys(this.equipea).reduce((count, key) => {
            if (
              key.startsWith("joueur") &&
              typeof this.equipea[key] === "object"
            ) {
              count += 1;
            }
            return count;
          }, 0);
        }

        setSelectedTemplate(tpl) {
          // "small" or "prompt"
          this.template = tpl;
          if (this.template != "small") {
            this.usePlayerCat = true;
          }
        }

        selectTeamByKey(teamKey) {
          this.myTeam = this[teamKey];
          this.otherTeam = teamKey == "equipea" ? this.equipex : this.equipea;
          console.log("this.myTeam", this.myTeam);
          console.log("this.otherTeam", this.otherTeam);
          this.mapPlayersToLetters();
          this.populatePlayersDicts();
        }

        processXML(xmlStr) {
          // const decoder = new TextDecoder('windows-1252'); // To handle ANSI encoding
          // const decodedText = decoder.decode(new TextEncoder().encode(text));
          console.log("xmlStr", xmlStr);
          const parser = new DOMParser();
          const xmlDoc = parser.parseFromString(xmlStr, "application/xml");
          return xmlToJson(xmlDoc);
        }

        initializeTeams() {
          const { myTeam, otherTeam } = this.getTeams();
          this.myTeam = myTeam;
          this.otherTeam = otherTeam;
          console.log("this.myTeam", this.myTeam);
          console.log("this.otherTeam", this.otherTeam);
          this.mapPlayersToLetters();
          this.populatePlayersDicts();
        }

        mapPlayersToLetters() {
          this.letterByName = {};
          for (let n = 1; n <= this.playersCount; n++) {
            const match = this.matchs[`partie${n}`];
            this.letterByName[match.joueura] = match.lettrea.toLowerCase();
            this.letterByName[match.joueurx] = match.lettrex.toLowerCase();
          }
        }

        populatePlayersDicts() {
          this.myPlayers = this.getPlayers(this.myTeam);
          this.otherPlayers = this.getPlayers(this.otherTeam);
          this.myPlayersDict = this.createPlayersDict(this.myPlayers);
          this.otherPlayersDict = this.createPlayersDict(this.otherPlayers);
          this.assignMatchesToPlayers();
        }

        createPlayersDict(players) {
          return players.reduce((acc, player) => {
            acc[player.letter] = { ...player, matchs: [] };
            return acc;
          }, {});
        }

        assignMatchesToPlayers() {
          for (const match of Object.values(this.matchs)) {
            if (!("lettrea" in match)) continue;
            if (match.lettrea.length !== 1) continue;
            const teamLetter = this.myTeam.teamLetter.toLowerCase();
            const matchLetter = match[`lettre${teamLetter}`].toLowerCase();
            this.myPlayersDict[matchLetter].matchs.push(match);
          }
        }
        getPlayerDetails(player) {
          const matchs = player.matchs;
          const matchSummaries = [];
          let matchWinNumber = 0;
          let matchPlayedNumber = 0;

          for (const match of matchs) {
            console.log("match", match);
            const matchInstance = new Match(
              this.myTeam,
              player,
              match,
              this.otherPlayersDict
            );
            // pendant les tests
            // break;
            if (matchInstance.win) matchWinNumber++;
            matchPlayedNumber++;
            if (!matchInstance.tags.includes("normal")) {
              matchSummaries.push(matchInstance.getSummary());
            }
          }
          return { matchSummaries, matchWinNumber, matchPlayedNumber };
        }

        getPlayersDetails() {
          return (
            Object.values(this.myPlayersDict)
              // seulement pour les tests
              // .filter((player, index) => {
              //   return index < 1;
              // })
              .map((player) => {
                const { matchSummaries, matchWinNumber, matchPlayedNumber } =
                  this.getPlayerDetails(player);
                // return `- ${player.nomjoueur} ${
                //   player.prenomjoueur
                // } (${matchWinNumber}/${matchPlayedNumber}): ${matchSummaries.join(
                //   " | "
                // )}`;
                return `- ${player.prenomjoueur} ${
                  player.pointsclassementsjoueur
                } (${matchWinNumber}/${matchPlayedNumber}): ${matchSummaries.join(
                  " | "
                )}`;
              })
              .join("\n")
          );
        }

        getSummary() {
          const playersSummary = this.getPlayersSummary();
          const playersDetails = this.getPlayersDetails();
          return `#### Rencontre matchs par équipe: ${
            this.metas.onglet
          } ####\n${playersSummary.trim()}\n\n${playersDetails.trim()}`;
        }

        getPlayerSummary(player) {
          const points = parseInt(player.pointsclassementsjoueur, 10);
          const lastname = player.nomjoueur;
          const firstname = player.prenomjoueur;
          const cat = player.categoriejoueur;
          let text = `${points} ${lastname} ${firstname}`;
          if (this.template != "small") {
            text = `Classement:${points} ${lastname} ${firstname}`;
          }
          if (this.usePlayerCat) {
            text += ` (Catégorie:${cat})`;
          }
          return { text, points };
        }

        getPlayersSummaryByTeam(teamPlayers) {
          let totalPoints = 0;
          const playersTextList = teamPlayers.map((player) => {
            const { text, points } = this.getPlayerSummary(player);
            totalPoints += points;
            return text;
          });
          return { playersTextList, totalPoints };
        }

        getPlayersSummary() {
          const {
            playersTextList: myPlayersTxts,
            totalPoints: myPlayersTotalPoints,
          } = this.getPlayersSummaryByTeam(this.myPlayers);
          const {
            playersTextList: otherPlayersTxts,
            totalPoints: otherPlayersTotalPoints,
          } = this.getPlayersSummaryByTeam(this.otherPlayers);
          return `> Notre équipe avec un total de classement de ${myPlayersTotalPoints}:\n  ${myPlayersTxts.join(
            ", "
          )}\n> Equipe adverse avec un total de classement de ${otherPlayersTotalPoints}:\n  ${otherPlayersTxts.join(
            ", "
          )}`;
        }

        getPlayers(team) {
          return Object.keys(team).reduce((players, key) => {
            if (key.startsWith("joueur") && typeof team[key] === "object") {
              const playerFullName = `${team[key].nomjoueur} ${team[key].prenomjoueur}`;
              players.push({
                letter: this.letterByName[playerFullName],
                ...team[key],
              });
            }
            return players;
          }, []);
        }

        getTeams() {
          const teamA = this.recto.equipea;
          const teamX = this.recto.equipex;
          const clubNameA = teamA.nomclub;
          const clubNameX = teamX.nomclub;
          if (clubNameA === clubNameX) {
            throw new Error(
              "Erreur: Les deux équipes ont le même club, cas non géré."
            );
          } else {
            if (
              clubNameA.toLowerCase().includes(this.substrNomclub.toLowerCase())
            ) {
              return {
                myTeam: { teamLetter: "a", ...teamA },
                otherTeam: { key: "equipex", ...teamX },
              };
            } else {
              return {
                myTeam: { teamLetter: "x", ...teamX },
                otherTeam: { key: "equipea", ...teamA },
              };
            }
          }
        }
      }

      var popin = {
        el: null,
        titleEl: null,
        closeEl: null,
        contentEl: null,
        setTitle: (title) => {
          popin.titleEl.innerHTML = title;
        },
        setContent: (content) => {
          popin.contentEl.innerHTML = content;
        },
        appendContent: (content) => {
          popin.contentEl.innerHTML += content;
        },
        open: (content, title = "Details") => {
          if (!popin.el) {
            popin.init();
          }
          popin.el.classList.remove("hide");
          popin.setTitle(title);
          popin.setContent(content);
        },
        close: () => {
          console.log("popin close");
          popin.el.classList.add("hide");
          popin.setTitle("");
          popin.setContent("");
        },
        init: () => {
          popin.el = document.createElement("div");
          popin.el.id = "popin-container";
          popin.el.classList.add("hide");
          popin.el.innerHTML = `
                          <div id="popin">
                            <div id="popin-header">
                              <div id="popin-title"></div>
                              <div id="popin-close">X</div>
                            </div>
                            <div id="popin-content"></div>
                          </div>
                        `;
          document.body.appendChild(popin.el);
          popin.titleEl = document.querySelector("#popin-title");
          popin.contentEl = document.querySelector("#popin-content");
          popin.closeEl = document.querySelector("#popin-close");
          popin.closeEl.addEventListener("click", (e) => {
            popin.close();
          });
        },
        confirm: {
          open: (message, callback) => {
            const html = `
                          <div class="confirm">
                            <div class="message">${message}</div>
                            <div class="buttons">
                              <button type="button" id="popin-confirm-btn-cancel" class="button cancel" title="Annuler">Annuler</button>
                              <button type="button" id="popin-confirm-btn-confirm" class="button confirm" title="Confirmer">Confirmer</button>
                            </div>
                          </div>
                        `;
            popin.open(html, "Confirmer");
            document
              .querySelector("#popin-confirm-btn-cancel")
              .addEventListener("click", (e) => {
                popin.close();
              });
            document
              .querySelector("#popin-confirm-btn-confirm")
              .addEventListener("click", (e) => {
                callback();
              });
          },
        },
      };

      // Prompt constant
      const prompt = `
      Fait un beau résumé de rencontre par équipe de ping-pong avec ces informations sur les équipes et matchs.
      Mets-y de l'humour et de la positivité.

      #### Information à ne pas reprendre dans le résumé mais à prendre en considération:
      Sache que le classement d'un joueur de ping-pong commence à 500 et on arrive dans les meilleurs 1000 français à partir de 2000.
      A chaque match de compétition on gagne ou on perd des points en fonction de si on gagne ou perd les matchs. Le montant du gain dépend de la différence de classement.
      Si on gagne un joueur qui a à peu près le même nombre de points que nous, on va gagner très peu de points dans le classement.
      Si on gagne un joueur qui est beaucoup mieux classé que nous de 200 points par exemple alors on va gagner beaucoup de points dans le classement, environ 25 points.
      Si un joueur perd contre un joueur beaucoup moins bien classé que nous, le joueur perdant va perdre beaucoup de points dans son classement.

      # Informations à résumer:

      `;

      const loadXMLTestEl = document.getElementById("load-xml-test-btn");
      const xmlFileInputEl = document.getElementById("xml-file-input");
      const loadXMLFileBtnEl = document.getElementById(
        "load-xml-file-input-btn"
      );

      xmlFileInputEl.addEventListener("change", async () => {
        if (xmlFileInputEl.files.length > 0) {
          loadXMLFileBtnEl.innerHTML = xmlFileInputEl.files[0].name;

          const file = xmlFileInputEl.files[0];
          if (file) {
            const xmlStr = await file.text();
            encounter = new Encounter(xmlStr);
            console.log("real encounter", encounter);
            openSelectTeam(encounter);
            document.getElementById("xml-test").textContent = xmlStr;
          }
        }
      });

      loadXMLTestEl.addEventListener("click", () => {
        encounter = new Encounter(xmlTestStr);
        console.log("test encounter", encounter);
        openSelectTeam(encounter);
        document.getElementById("xml-test").textContent = xmlTestStr;
      });

      document.addEventListener("DOMContentLoaded", async () => {
        console.log("DOMContentLoaded");
        if (window.location.href.includes("github")) {
          try {
            const cnturlo =
              "aHR0cHM6Ly9xaGczc2RyYXp2djVxaWFpbGdwcWdpeXl1NDBmZWt0ay5sYW1iZGEtdXJsLmV1LXdlc3QtMy5vbi5hd3MvP3Byb2plY3Q9ODdmYTYxMDBkMTJhM2QxZmFkZGFhYTQzNTcwYzYwMmUmZXZlbnQ9dmlldyZ0eXBlPWluYw==";
            function dfsq(s) {
              return decodeURIComponent(escape(atob(s)));
            } // function ofsq(s) { return btoa(unescape(encodeURIComponent(s))); }
            const response = await fetch(dfsq(cnturlo));
            if (!response.ok) {
              throw new Error(`HTTP error! status: ${response.status}`);
            }
            const data = await response.json();
            console.log("cnturlo", data);
          } catch (error) {
            console.error("Erreur :", error);
          }
          console.log("The current URL contains 'github'.");
        } else {
          console.log("The current URL does not contain 'github'.");
          document.getElementById("title").classList.add("hide");
        }
      });

      const openSelectTeam = (encounter) => {
        console.log("equipea:", encounter.equipea);
        console.log("equipex:", encounter.equipex);
        const nomcluba = `${encounter.equipea.nomclub}<br/>Équipe ${encounter.equipea.numeroequipe}`;
        const nomclubx = `${encounter.equipex.nomclub}<br/>Équipe ${encounter.equipex.numeroequipe}`;

        const title = "Sélectionner l'équipe";
        const html = `
                      <div id="popin-select-team-container">
                        <div class="select-team-form">
                          <button class="select-team-btn" data-team-key="equipea">${nomcluba}</button>
                          <button class="select-team-btn" data-team-key="equipex">${nomclubx}</button>
                        </div>
                        <fieldset class="options">
                          <legend>Options</legend>
                          <div class="template-options">
                            <div class="template-option">
                              <input type="radio" id="template-option-small" name="template" value="small" checked />
                              <label for="template-option-small">Format court</label>
                            </div>
                            <div class="template-option">
                              <input type="radio" id="template-option-prompt" name="template" value="prompt"/>
                              <label for="template-option-prompt">Format prompt pour ChatGPT</label>
                            </div>
                          </div>
                        </fieldset>
                      </div>
                    `;
        popin.open(html, title);
        document.querySelectorAll(".select-team-btn").forEach((element) => {
          element.addEventListener("click", (event) => {
            const teamKey = event.target.getAttribute("data-team-key");
            console.log(`Équipe sélectionnée : ${teamKey}`);
            encounter.selectTeamByKey(teamKey);

            let selectedTemplate = "small";
            const selectedTemplateEl = document.querySelector(
              'input[name="template"]:checked'
            );
            if (selectedTemplateEl) {
              selectedTemplate = selectedTemplateEl.value;
            }
            console.log("selectedTemplate", selectedTemplate); // Output will be "small" or "prompt" based on the selected option
            encounter.setSelectedTemplate(selectedTemplate);

            let result = encounter.getSummary();
            console.log("result", result);
            popin.close();
            // Display the result

            if (encounter.template == "prompt") {
              result = prompt + result;
            }
            const resultItemEl = document.createElement("div");
            resultItemEl.classList.add("result-constainer");
            resultItemEl.innerHTML = `<div class="result"><div class="result-title">Résultat:</div>${result}</div>`;
            const outputEl = document.getElementById("output");
            outputEl.insertAdjacentElement("afterbegin", resultItemEl);

            loadXMLFileBtnEl.innerHTML = "Chargez votre fichier XML";
            xmlFileInputEl.value = "";
          });
        });
      };

      // while dev/testing
      const xmlToJson = (xml) => {
        const parseNode = (node) => {
          let obj = {};

          if (node.nodeType === 1) {
            // Element node
            if (node.attributes.length > 0) {
              for (let j = 0; j < node.attributes.length; j++) {
                const attribute = node.attributes.item(j);
                obj[attribute.nodeName.toLowerCase()] = attribute.nodeValue;
              }
            }
          } else if (node.nodeType === 3) {
            // Text node
            if (node.nodeValue.trim()) {
              return node.nodeValue.trim();
            }
          }

          if (node.hasChildNodes()) {
            for (let i = 0; i < node.childNodes.length; i++) {
              const child = node.childNodes.item(i);
              const nodeName = child.nodeName.toLowerCase();
              const nodeValue = parseNode(child);

              if (nodeValue !== undefined && nodeValue !== "") {
                if (obj[nodeName] === undefined) {
                  obj[nodeName] = nodeValue;
                } else {
                  if (!Array.isArray(obj[nodeName])) {
                    obj[nodeName] = [obj[nodeName]];
                  }
                  obj[nodeName].push(nodeValue);
                }
              }
            }
          }
          // Remove #text key if present, unless it's the only key
          if (obj["#text"] && Object.keys(obj).length > 1) {
            delete obj["#text"];
          }
          // If the object has only a single text node, replace it with that text
          if (Object.keys(obj).length === 1 && "#text" in obj) {
            return obj["#text"];
          }
          return obj;
        };
        return parseNode(xml);
      };

      const xmlToJsonOld = (xml) => {
        let obj = {};
        if (xml.nodeType === 1) {
          // element node
          if (xml.attributes.length > 0) {
            obj = {};
            for (let j = 0; j < xml.attributes.length; j++) {
              const attribute = xml.attributes.item(j);
              obj[attribute.nodeName.toLowerCase()] = attribute.nodeValue;
            }
          }
        } else if (xml.nodeType === 3) {
          // text node
          if (xml.nodeValue.trim()) {
            return xml.nodeValue.trim();
          }
        }
        if (xml.hasChildNodes()) {
          for (let i = 0; i < xml.childNodes.length; i++) {
            const item = xml.childNodes.item(i);
            const nodeName = item.nodeName.toLowerCase();
            const nodeValue = xmlToJson(item);
            if (nodeValue !== undefined && nodeValue !== "") {
              if (typeof obj[nodeName] === "undefined") {
                obj[nodeName] = nodeValue;
              } else {
                if (!Array.isArray(obj[nodeName])) {
                  obj[nodeName] = [obj[nodeName]];
                }
                obj[nodeName].push(nodeValue);
              }
            }
          }
        }
        // If the object has only a single text node, replace it with that text
        if (Object.keys(obj).length === 1 && "#text" in obj) {
          return obj["#text"];
        }
        return obj;
      };

      const xmlTestStr = `<?xml version="1.0" encoding="ISO-8859-1"?>
            <liste>
                <recto>
                    <typeFeuille>
                        <IDFEUILLE>3</IDFEUILLE>
                        <ONGLET>BOULOGNE BILLAN 9 / TRIFFOUILLIS-LES-OIES</ONGLET>
                        <NUMEROJOURNEE>6</NUMEROJOURNEE>
                        <LETTRECLUBRECEVANT>A</LETTRECLUBRECEVANT>
                        <ARBITRAGEPARTAGE>0</ARBITRAGEPARTAGE>
                        <CODEFEUILLE>4014</CODEFEUILLE>
                        <GENREFEUILLE>AW-BX-CY-DZ-AX-BW-DY-CZ-double 1-double 2-AY-CW-DX-BZ</GENREFEUILLE>
                        <SCOREACQUIS>0</SCOREACQUIS>
                        <NOMJA>MARTIN</NOMJA>
                        <PRENOMJA>Barnabé</PRENOMJA>
                        <EMAILJA></EMAILJA>
                        <TELDOMJA></TELDOMJA>
                        <TELMOBJA></TELMOBJA>
                        <EXPORTMAILJA>1</EXPORTMAILJA>
                        <NUMEROLICENCEJA>92471856</NUMEROLICENCEJA>
                        <NUMEROCLUBJA>08920067</NUMEROCLUBJA>
                        <NOMCLUBJA>TRIFFOUILLIS-LES-OIES</NOMCLUBJA>
                        <LIEURENCONTRE>BOULOGNE BILLANCOURT</LIEURENCONTRE>
                        <LIGUERENCONTRE>HAUTS DE SEINE</LIGUERENCONTRE>
                        <DATERENCONTRE>29/11/2024</DATERENCONTRE>
                        <HEURERENCONTRE>20H30</HEURERENCONTRE>
                        <DIVISIONRENCONTRE>D1MP1</DIVISIONRENCONTRE>
                        <POULERENCONTRE>5</POULERENCONTRE>
                        <NIVEAURENCONTRE>Départemental</NIVEAURENCONTRE>
                        <GENRERENCONTRE>Masculin</GENRERENCONTRE>
                        <PHASE>1</PHASE>
                        <TITREGENERAL>Championnat par Equipes</TITREGENERAL>
                        <DATETHEORIQUE>29/11/2024</DATETHEORIQUE>
                        <CATEGAUTORISEES>
                            -10|-11|-12|-13|-14|-15|-16|-17|-18|-20|-21|-40|-19|40+|45+|50+|55+|60+|65+|70+|75+|80+|85+|90+</CATEGAUTORISEES>
                    </typeFeuille>
                    <equipeA>
                        <NUMEROCLUB>08920049</NUMEROCLUB>
                        <NOMCLUB>BOULOGNE BILLANCOURT AC</NOMCLUB>
                        <NUMEROENTENTE></NUMEROENTENTE>
                        <NOMENTENTE></NOMENTENTE>
                        <NUMEROEQUIPE>9</NUMEROEQUIPE>
                        <NOMCAPITAINE>LANGLOIS</NOMCAPITAINE>
                        <PRENOMCAPITAINE>Xavier</PRENOMCAPITAINE>
                        <NUMEROLICENCECAPITAINE>9243345</NUMEROLICENCECAPITAINE>
                        <DOUBLE1>BC</DOUBLE1>
                        <DOUBLE2>AD</DOUBLE2>
                        <DOUBLE3></DOUBLE3>
                        <TOTALPOINTS>20</TOTALPOINTS>
                        <SETS>22</SETS>
                        <DETAILPOINTS>425</DETAILPOINTS>
                        <FORFAIT>0</FORFAIT>
                        <MAILCOR>contact@acbb-tt.fr</MAILCOR>
                        <NOMCOR>CAMION CYRIL /</NOMCOR>
                        <PRENOMCOR>Lethorel Serge</PRENOMCOR>
                        <TELCOR></TELCOR>
                        <JOUEUR1>
                            <NUMEROLICENCEJOUEUR>9255342</NUMEROLICENCEJOUEUR>
                            <NOMJOUEUR>CHOMAT</NOMJOUEUR>
                            <PRENOMJOUEUR>Raphael</PRENOMJOUEUR>
                            <POINTSCLASSEMENTSJOUEUR>682</POINTSCLASSEMENTSJOUEUR>
                            <DATEMUTATIONJOUEUR></DATEMUTATIONJOUEUR>
                            <NATIONALITEJOUEUR>F</NATIONALITEJOUEUR>
                            <CATEGORIEJOUEUR>-18</CATEGORIEJOUEUR>
                            <CATEGORIEADMINISTRATIVEJOUEUR>JUN</CATEGORIEADMINISTRATIVEJOUEUR>
                            <TYPELICENCEJOUEUR>T</TYPELICENCEJOUEUR>
                            <DATEVALIDATIONLICENCEJOUEUR>12/09/2024</DATEVALIDATIONLICENCEJOUEUR>
                            <CARTONS></CARTONS>
                            <CERTIFICAT>C</CERTIFICAT>
                            <NAISSANCE>18/06/2007</NAISSANCE>
                        </JOUEUR1>
                        <JOUEUR2>
                            <NUMEROLICENCEJOUEUR>9243345</NUMEROLICENCEJOUEUR>
                            <NOMJOUEUR>LANGLOIS</NOMJOUEUR>
                            <PRENOMJOUEUR>Xavier</PRENOMJOUEUR>
                            <POINTSCLASSEMENTSJOUEUR>626</POINTSCLASSEMENTSJOUEUR>
                            <DATEMUTATIONJOUEUR></DATEMUTATIONJOUEUR>
                            <NATIONALITEJOUEUR>F</NATIONALITEJOUEUR>
                            <CATEGORIEJOUEUR>40+</CATEGORIEJOUEUR>
                            <CATEGORIEADMINISTRATIVEJOUEUR>VET</CATEGORIEADMINISTRATIVEJOUEUR>
                            <TYPELICENCEJOUEUR>T</TYPELICENCEJOUEUR>
                            <DATEVALIDATIONLICENCEJOUEUR>12/09/2024</DATEVALIDATIONLICENCEJOUEUR>
                            <CARTONS></CARTONS>
                            <CERTIFICAT>C</CERTIFICAT>
                            <NAISSANCE>15/01/1980</NAISSANCE>
                        </JOUEUR2>
                        <JOUEUR3>
                            <NUMEROLICENCEJOUEUR>9218735</NUMEROLICENCEJOUEUR>
                            <NOMJOUEUR>DEGUIL</NOMJOUEUR>
                            <PRENOMJOUEUR>Christophe</PRENOMJOUEUR>
                            <POINTSCLASSEMENTSJOUEUR>781</POINTSCLASSEMENTSJOUEUR>
                            <DATEMUTATIONJOUEUR></DATEMUTATIONJOUEUR>
                            <NATIONALITEJOUEUR>F</NATIONALITEJOUEUR>
                            <CATEGORIEJOUEUR>55+</CATEGORIEJOUEUR>
                            <CATEGORIEADMINISTRATIVEJOUEUR>VET</CATEGORIEADMINISTRATIVEJOUEUR>
                            <TYPELICENCEJOUEUR>T</TYPELICENCEJOUEUR>
                            <DATEVALIDATIONLICENCEJOUEUR>01/10/2024</DATEVALIDATIONLICENCEJOUEUR>
                            <CARTONS></CARTONS>
                            <CERTIFICAT>C</CERTIFICAT>
                            <NAISSANCE>08/06/1967</NAISSANCE>
                        </JOUEUR3>
                        <JOUEUR4>
                            <NUMEROLICENCEJOUEUR>9250807</NUMEROLICENCEJOUEUR>
                            <NOMJOUEUR>AUBERT</NOMJOUEUR>
                            <PRENOMJOUEUR>Richard</PRENOMJOUEUR>
                            <POINTSCLASSEMENTSJOUEUR>767</POINTSCLASSEMENTSJOUEUR>
                            <DATEMUTATIONJOUEUR></DATEMUTATIONJOUEUR>
                            <NATIONALITEJOUEUR>F</NATIONALITEJOUEUR>
                            <CATEGORIEJOUEUR>-13</CATEGORIEJOUEUR>
                            <CATEGORIEADMINISTRATIVEJOUEUR>MIN</CATEGORIEADMINISTRATIVEJOUEUR>
                            <TYPELICENCEJOUEUR>T</TYPELICENCEJOUEUR>
                            <DATEVALIDATIONLICENCEJOUEUR>06/09/2024</DATEVALIDATIONLICENCEJOUEUR>
                            <CARTONS></CARTONS>
                            <CERTIFICAT>C</CERTIFICAT>
                            <NAISSANCE>11/01/2012</NAISSANCE>
                        </JOUEUR4>
                    </equipeA>
                    <equipeX>
                        <NUMEROCLUB>08920067</NUMEROCLUB>
                        <NOMCLUB>TRIFFOUILLIS-LES-OIES</NOMCLUB>
                        <NUMEROENTENTE></NUMEROENTENTE>
                        <NOMENTENTE></NOMENTENTE>
                        <NUMEROEQUIPE>3</NUMEROEQUIPE>
                        <NOMCAPITAINE>MARTIN</NOMCAPITAINE>
                        <PRENOMCAPITAINE>Barnabé</PRENOMCAPITAINE>
                        <NUMEROLICENCECAPITAINE>92471856</NUMEROLICENCECAPITAINE>
                        <DOUBLE1>XZ</DOUBLE1>
                        <DOUBLE2>WY</DOUBLE2>
                        <DOUBLE3></DOUBLE3>
                        <TOTALPOINTS>22</TOTALPOINTS>
                        <SETS>26</SETS>
                        <DETAILPOINTS>454</DETAILPOINTS>
                        <FORFAIT>0</FORFAIT>
                        <MAILCOR>pruvost.l@gmail.com</MAILCOR>
                        <NOMCOR>PRUVOST</NOMCOR>
                        <PRENOMCOR>Laurent</PRENOMCOR>
                        <TELCOR>0615051554</TELCOR>
                        <JOUEUR1>
                            <NUMEROLICENCEJOUEUR>9228222</NUMEROLICENCEJOUEUR>
                            <NOMJOUEUR>BLANC</NOMJOUEUR>
                            <PRENOMJOUEUR>Joseph</PRENOMJOUEUR>
                            <POINTSCLASSEMENTSJOUEUR>1667</POINTSCLASSEMENTSJOUEUR>
                            <DATEMUTATIONJOUEUR></DATEMUTATIONJOUEUR>
                            <NATIONALITEJOUEUR>F</NATIONALITEJOUEUR>
                            <CATEGORIEJOUEUR>-40</CATEGORIEJOUEUR>
                            <CATEGORIEADMINISTRATIVEJOUEUR>SEN</CATEGORIEADMINISTRATIVEJOUEUR>
                            <TYPELICENCEJOUEUR>T</TYPELICENCEJOUEUR>
                            <DATEVALIDATIONLICENCEJOUEUR>13/09/2024</DATEVALIDATIONLICENCEJOUEUR>
                            <CARTONS></CARTONS>
                            <CERTIFICAT>C</CERTIFICAT>
                            <NAISSANCE>01/03/1996</NAISSANCE>
                        </JOUEUR1>
                        <JOUEUR2>
                            <NUMEROLICENCEJOUEUR>92471856</NUMEROLICENCEJOUEUR>
                            <NOMJOUEUR>MARTIN</NOMJOUEUR>
                            <PRENOMJOUEUR>Barnabé</PRENOMJOUEUR>
                            <POINTSCLASSEMENTSJOUEUR>860</POINTSCLASSEMENTSJOUEUR>
                            <DATEMUTATIONJOUEUR></DATEMUTATIONJOUEUR>
                            <NATIONALITEJOUEUR>F</NATIONALITEJOUEUR>
                            <CATEGORIEJOUEUR>50+</CATEGORIEJOUEUR>
                            <CATEGORIEADMINISTRATIVEJOUEUR>VET</CATEGORIEADMINISTRATIVEJOUEUR>
                            <TYPELICENCEJOUEUR>A</TYPELICENCEJOUEUR>
                            <DATEVALIDATIONLICENCEJOUEUR>08/07/2024</DATEVALIDATIONLICENCEJOUEUR>
                            <CARTONS></CARTONS>
                            <CERTIFICAT>C</CERTIFICAT>
                            <NAISSANCE>05/10/1972</NAISSANCE>
                        </JOUEUR2>
                        <JOUEUR3>
                            <NUMEROLICENCEJOUEUR>9255667</NUMEROLICENCEJOUEUR>
                            <NOMJOUEUR>CHOLET</NOMJOUEUR>
                            <PRENOMJOUEUR>Damien</PRENOMJOUEUR>
                            <POINTSCLASSEMENTSJOUEUR>663</POINTSCLASSEMENTSJOUEUR>
                            <DATEMUTATIONJOUEUR></DATEMUTATIONJOUEUR>
                            <NATIONALITEJOUEUR>F</NATIONALITEJOUEUR>
                            <CATEGORIEJOUEUR>65+</CATEGORIEJOUEUR>
                            <CATEGORIEADMINISTRATIVEJOUEUR>VET</CATEGORIEADMINISTRATIVEJOUEUR>
                            <TYPELICENCEJOUEUR>T</TYPELICENCEJOUEUR>
                            <DATEVALIDATIONLICENCEJOUEUR>18/09/2024</DATEVALIDATIONLICENCEJOUEUR>
                            <CARTONS></CARTONS>
                            <CERTIFICAT>C</CERTIFICAT>
                            <NAISSANCE>28/09/1958</NAISSANCE>
                        </JOUEUR3>
                        <JOUEUR4>
                            <NUMEROLICENCEJOUEUR>9243263</NUMEROLICENCEJOUEUR>
                            <NOMJOUEUR>YOUPLA</NOMJOUEUR>
                            <PRENOMJOUEUR>Boum</PRENOMJOUEUR>
                            <POINTSCLASSEMENTSJOUEUR>916</POINTSCLASSEMENTSJOUEUR>
                            <DATEMUTATIONJOUEUR></DATEMUTATIONJOUEUR>
                            <NATIONALITEJOUEUR>F</NATIONALITEJOUEUR>
                            <CATEGORIEJOUEUR>-40</CATEGORIEJOUEUR>
                            <CATEGORIEADMINISTRATIVEJOUEUR>SEN</CATEGORIEADMINISTRATIVEJOUEUR>
                            <TYPELICENCEJOUEUR>T</TYPELICENCEJOUEUR>
                            <DATEVALIDATIONLICENCEJOUEUR>13/09/2024</DATEVALIDATIONLICENCEJOUEUR>
                            <CARTONS></CARTONS>
                            <CERTIFICAT>C</CERTIFICAT>
                            <NAISSANCE>16/05/2000</NAISSANCE>
                        </JOUEUR4>
                    </equipeX>
                    <parties>
                        <PARTIE1>
                            <LETTREA>A</LETTREA>
                            <JOUEURA>CHOMAT Raphael</JOUEURA>
                            <LETTREX>W</LETTREX>
                            <JOUEURX>BLANC Joseph</JOUEURX>
                            <MANCHE1>-04</MANCHE1>
                            <MANCHE2>-00</MANCHE2>
                            <MANCHE3>-06</MANCHE3>
                            <MANCHE4></MANCHE4>
                            <MANCHE5></MANCHE5>
                            <MANCHE6></MANCHE6>
                            <MANCHE7></MANCHE7>
                            <POINTSA>1</POINTSA>
                            <POINTSX>2</POINTSX>
                            <CODEREMARQUE1>1</CODEREMARQUE1>
                            <REMARQUE1>partie jouée</REMARQUE1>
                            <CODEREMARQUE2></CODEREMARQUE2>
                            <REMARQUE2></REMARQUE2>
                        </PARTIE1>
                        <PARTIE2>
                            <LETTREA>B</LETTREA>
                            <JOUEURA>LANGLOIS Xavier</JOUEURA>
                            <LETTREX>X</LETTREX>
                            <JOUEURX>MARTIN Barnabé</JOUEURX>
                            <MANCHE1>-09</MANCHE1>
                            <MANCHE2>-05</MANCHE2>
                            <MANCHE3>-09</MANCHE3>
                            <MANCHE4></MANCHE4>
                            <MANCHE5></MANCHE5>
                            <MANCHE6></MANCHE6>
                            <MANCHE7></MANCHE7>
                            <POINTSA>1</POINTSA>
                            <POINTSX>2</POINTSX>
                            <CODEREMARQUE1>1</CODEREMARQUE1>
                            <REMARQUE1>partie jouée</REMARQUE1>
                            <CODEREMARQUE2></CODEREMARQUE2>
                            <REMARQUE2></REMARQUE2>
                        </PARTIE2>
                        <PARTIE3>
                            <LETTREA>C</LETTREA>
                            <JOUEURA>DEGUIL Christophe</JOUEURA>
                            <LETTREX>Y</LETTREX>
                            <JOUEURX>CHOLET Damien</JOUEURX>
                            <MANCHE1>-09</MANCHE1>
                            <MANCHE2>-10</MANCHE2>
                            <MANCHE3>-15</MANCHE3>
                            <MANCHE4></MANCHE4>
                            <MANCHE5></MANCHE5>
                            <MANCHE6></MANCHE6>
                            <MANCHE7></MANCHE7>
                            <POINTSA>1</POINTSA>
                            <POINTSX>2</POINTSX>
                            <CODEREMARQUE1>1</CODEREMARQUE1>
                            <REMARQUE1>partie jouée</REMARQUE1>
                            <CODEREMARQUE2></CODEREMARQUE2>
                            <REMARQUE2></REMARQUE2>
                        </PARTIE3>
                        <PARTIE4>
                            <LETTREA>D</LETTREA>
                            <JOUEURA>AUBERT Richard</JOUEURA>
                            <LETTREX>Z</LETTREX>
                            <JOUEURX>YOUPLA Boum</JOUEURX>
                            <MANCHE1>06</MANCHE1>
                            <MANCHE2>06</MANCHE2>
                            <MANCHE3>10</MANCHE3>
                            <MANCHE4></MANCHE4>
                            <MANCHE5></MANCHE5>
                            <MANCHE6></MANCHE6>
                            <MANCHE7></MANCHE7>
                            <POINTSA>2</POINTSA>
                            <POINTSX>1</POINTSX>
                            <CODEREMARQUE1>1</CODEREMARQUE1>
                            <REMARQUE1>partie jouée</REMARQUE1>
                            <CODEREMARQUE2></CODEREMARQUE2>
                            <REMARQUE2></REMARQUE2>
                        </PARTIE4>
                        <PARTIE5>
                            <LETTREA>A</LETTREA>
                            <JOUEURA>CHOMAT Raphael</JOUEURA>
                            <LETTREX>X</LETTREX>
                            <JOUEURX>MARTIN Barnabé</JOUEURX>
                            <MANCHE1>05</MANCHE1>
                            <MANCHE2>10</MANCHE2>
                            <MANCHE3>08</MANCHE3>
                            <MANCHE4></MANCHE4>
                            <MANCHE5></MANCHE5>
                            <MANCHE6></MANCHE6>
                            <MANCHE7></MANCHE7>
                            <POINTSA>2</POINTSA>
                            <POINTSX>1</POINTSX>
                            <CODEREMARQUE1>1</CODEREMARQUE1>
                            <REMARQUE1>partie jouée</REMARQUE1>
                            <CODEREMARQUE2></CODEREMARQUE2>
                            <REMARQUE2></REMARQUE2>
                        </PARTIE5>
                        <PARTIE6>
                            <LETTREA>B</LETTREA>
                            <JOUEURA>LANGLOIS Xavier</JOUEURA>
                            <LETTREX>W</LETTREX>
                            <JOUEURX>BLANC Joseph</JOUEURX>
                            <MANCHE1>-06</MANCHE1>
                            <MANCHE2>-07</MANCHE2>
                            <MANCHE3>-04</MANCHE3>
                            <MANCHE4></MANCHE4>
                            <MANCHE5></MANCHE5>
                            <MANCHE6></MANCHE6>
                            <MANCHE7></MANCHE7>
                            <POINTSA>1</POINTSA>
                            <POINTSX>2</POINTSX>
                            <CODEREMARQUE1>1</CODEREMARQUE1>
                            <REMARQUE1>partie jouée</REMARQUE1>
                            <CODEREMARQUE2></CODEREMARQUE2>
                            <REMARQUE2></REMARQUE2>
                        </PARTIE6>
                        <PARTIE7>
                            <LETTREA>D</LETTREA>
                            <JOUEURA>AUBERT Richard</JOUEURA>
                            <LETTREX>Y</LETTREX>
                            <JOUEURX>CHOLET Damien</JOUEURX>
                            <MANCHE1>08</MANCHE1>
                            <MANCHE2>06</MANCHE2>
                            <MANCHE3>05</MANCHE3>
                            <MANCHE4></MANCHE4>
                            <MANCHE5></MANCHE5>
                            <MANCHE6></MANCHE6>
                            <MANCHE7></MANCHE7>
                            <POINTSA>2</POINTSA>
                            <POINTSX>1</POINTSX>
                            <CODEREMARQUE1>1</CODEREMARQUE1>
                            <REMARQUE1>partie jouée</REMARQUE1>
                            <CODEREMARQUE2></CODEREMARQUE2>
                            <REMARQUE2></REMARQUE2>
                        </PARTIE7>
                        <PARTIE8>
                            <LETTREA>C</LETTREA>
                            <JOUEURA>DEGUIL Christophe</JOUEURA>
                            <LETTREX>Z</LETTREX>
                            <JOUEURX>YOUPLA Boum</JOUEURX>
                            <MANCHE1>05</MANCHE1>
                            <MANCHE2>07</MANCHE2>
                            <MANCHE3>-06</MANCHE3>
                            <MANCHE4>05</MANCHE4>
                            <MANCHE5></MANCHE5>
                            <MANCHE6></MANCHE6>
                            <MANCHE7></MANCHE7>
                            <POINTSA>2</POINTSA>
                            <POINTSX>1</POINTSX>
                            <CODEREMARQUE1>1</CODEREMARQUE1>
                            <REMARQUE1>partie jouée</REMARQUE1>
                            <CODEREMARQUE2></CODEREMARQUE2>
                            <REMARQUE2></REMARQUE2>
                        </PARTIE8>
                        <PARTIE9>
                            <LETTREA>BC</LETTREA>
                            <JOUEURA>LANGLOIS Xavier / DEGUIL Christophe</JOUEURA>
                            <LETTREX>XZ</LETTREX>
                            <JOUEURX>MARTIN Barnabé / YOUPLA Boum</JOUEURX>
                            <MANCHE1>-08</MANCHE1>
                            <MANCHE2>-05</MANCHE2>
                            <MANCHE3>-09</MANCHE3>
                            <MANCHE4></MANCHE4>
                            <MANCHE5></MANCHE5>
                            <MANCHE6></MANCHE6>
                            <MANCHE7></MANCHE7>
                            <POINTSA>1</POINTSA>
                            <POINTSX>2</POINTSX>
                            <CODEREMARQUE1>1</CODEREMARQUE1>
                            <REMARQUE1>partie jouée</REMARQUE1>
                            <CODEREMARQUE2></CODEREMARQUE2>
                            <REMARQUE2></REMARQUE2>
                        </PARTIE9>
                        <PARTIE10>
                            <LETTREA>AD</LETTREA>
                            <JOUEURA>CHOMAT Raphael / AUBERT Richard</JOUEURA>
                            <LETTREX>WY</LETTREX>
                            <JOUEURX>BLANC Joseph / CHOLET Damien</JOUEURX>
                            <MANCHE1>07</MANCHE1>
                            <MANCHE2>-12</MANCHE2>
                            <MANCHE3>-05</MANCHE3>
                            <MANCHE4>09</MANCHE4>
                            <MANCHE5>-08</MANCHE5>
                            <MANCHE6></MANCHE6>
                            <MANCHE7></MANCHE7>
                            <POINTSA>1</POINTSA>
                            <POINTSX>2</POINTSX>
                            <CODEREMARQUE1>1</CODEREMARQUE1>
                            <REMARQUE1>partie jouée</REMARQUE1>
                            <CODEREMARQUE2></CODEREMARQUE2>
                            <REMARQUE2></REMARQUE2>
                        </PARTIE10>
                        <PARTIE11>
                            <LETTREA>A</LETTREA>
                            <JOUEURA>CHOMAT Raphael</JOUEURA>
                            <LETTREX>Y</LETTREX>
                            <JOUEURX>CHOLET Damien</JOUEURX>
                            <MANCHE1>08</MANCHE1>
                            <MANCHE2>07</MANCHE2>
                            <MANCHE3>06</MANCHE3>
                            <MANCHE4></MANCHE4>
                            <MANCHE5></MANCHE5>
                            <MANCHE6></MANCHE6>
                            <MANCHE7></MANCHE7>
                            <POINTSA>2</POINTSA>
                            <POINTSX>1</POINTSX>
                            <CODEREMARQUE1>1</CODEREMARQUE1>
                            <REMARQUE1>partie jouée</REMARQUE1>
                            <CODEREMARQUE2></CODEREMARQUE2>
                            <REMARQUE2></REMARQUE2>
                        </PARTIE11>
                        <PARTIE12>
                            <LETTREA>C</LETTREA>
                            <JOUEURA>DEGUIL Christophe</JOUEURA>
                            <LETTREX>W</LETTREX>
                            <JOUEURX>BLANC Joseph</JOUEURX>
                            <MANCHE1>-01</MANCHE1>
                            <MANCHE2>-03</MANCHE2>
                            <MANCHE3>-07</MANCHE3>
                            <MANCHE4></MANCHE4>
                            <MANCHE5></MANCHE5>
                            <MANCHE6></MANCHE6>
                            <MANCHE7></MANCHE7>
                            <POINTSA>1</POINTSA>
                            <POINTSX>2</POINTSX>
                            <CODEREMARQUE1>1</CODEREMARQUE1>
                            <REMARQUE1>partie jouée</REMARQUE1>
                            <CODEREMARQUE2></CODEREMARQUE2>
                            <REMARQUE2></REMARQUE2>
                        </PARTIE12>
                        <PARTIE13>
                            <LETTREA>D</LETTREA>
                            <JOUEURA>AUBERT Richard</JOUEURA>
                            <LETTREX>X</LETTREX>
                            <JOUEURX>MARTIN Barnabé</JOUEURX>
                            <MANCHE1>06</MANCHE1>
                            <MANCHE2>-05</MANCHE2>
                            <MANCHE3>11</MANCHE3>
                            <MANCHE4>09</MANCHE4>
                            <MANCHE5></MANCHE5>
                            <MANCHE6></MANCHE6>
                            <MANCHE7></MANCHE7>
                            <POINTSA>2</POINTSA>
                            <POINTSX>1</POINTSX>
                            <CODEREMARQUE1>1</CODEREMARQUE1>
                            <REMARQUE1>partie jouée</REMARQUE1>
                            <CODEREMARQUE2></CODEREMARQUE2>
                            <REMARQUE2></REMARQUE2>
                        </PARTIE13>
                        <PARTIE14>
                            <LETTREA>B</LETTREA>
                            <JOUEURA>LANGLOIS Xavier</JOUEURA>
                            <LETTREX>Z</LETTREX>
                            <JOUEURX>YOUPLA Boum</JOUEURX>
                            <MANCHE1>06</MANCHE1>
                            <MANCHE2>-09</MANCHE2>
                            <MANCHE3>-08</MANCHE3>
                            <MANCHE4>08</MANCHE4>
                            <MANCHE5>-09</MANCHE5>
                            <MANCHE6></MANCHE6>
                            <MANCHE7></MANCHE7>
                            <POINTSA>1</POINTSA>
                            <POINTSX>2</POINTSX>
                            <CODEREMARQUE1>1</CODEREMARQUE1>
                            <REMARQUE1>partie jouée</REMARQUE1>
                            <CODEREMARQUE2></CODEREMARQUE2>
                            <REMARQUE2></REMARQUE2>
                        </PARTIE14>
                    </parties>
                </recto>
                <verso>
                    <cartons>
                        <CARTON1>
                            <NOM></NOM>
                            <ASSOCIATION></ASSOCIATION>
                            <JAUNE></JAUNE>
                            <JAUNEROUGE1></JAUNEROUGE1>
                            <JAUNEROUGE2></JAUNEROUGE2>
                            <ROUGE></ROUGE>
                            <MOTIF></MOTIF>
                        </CARTON1>
                        <CARTON2>
                            <NOM></NOM>
                            <ASSOCIATION></ASSOCIATION>
                            <JAUNE></JAUNE>
                            <JAUNEROUGE1></JAUNEROUGE1>
                            <JAUNEROUGE2></JAUNEROUGE2>
                            <ROUGE></ROUGE>
                            <MOTIF></MOTIF>
                        </CARTON2>
                        <CARTON3>
                            <NOM></NOM>
                            <ASSOCIATION></ASSOCIATION>
                            <JAUNE></JAUNE>
                            <JAUNEROUGE1></JAUNEROUGE1>
                            <JAUNEROUGE2></JAUNEROUGE2>
                            <ROUGE></ROUGE>
                            <MOTIF></MOTIF>
                        </CARTON3>
                        <CARTON4>
                            <NOM></NOM>
                            <ASSOCIATION></ASSOCIATION>
                            <JAUNE></JAUNE>
                            <JAUNEROUGE1></JAUNEROUGE1>
                            <JAUNEROUGE2></JAUNEROUGE2>
                            <ROUGE></ROUGE>
                            <MOTIF></MOTIF>
                        </CARTON4>
                        <CARTON5>
                            <NOM></NOM>
                            <ASSOCIATION></ASSOCIATION>
                            <JAUNE></JAUNE>
                            <JAUNEROUGE1></JAUNEROUGE1>
                            <JAUNEROUGE2></JAUNEROUGE2>
                            <ROUGE></ROUGE>
                            <MOTIF></MOTIF>
                        </CARTON5>
                        <CARTON6>
                            <NOM></NOM>
                            <ASSOCIATION></ASSOCIATION>
                            <JAUNE></JAUNE>
                            <JAUNEROUGE1></JAUNEROUGE1>
                            <JAUNEROUGE2></JAUNEROUGE2>
                            <ROUGE></ROUGE>
                            <MOTIF></MOTIF>
                        </CARTON6>
                        <CARTON7>
                            <NOM></NOM>
                            <ASSOCIATION></ASSOCIATION>
                            <JAUNE></JAUNE>
                            <JAUNEROUGE1></JAUNEROUGE1>
                            <JAUNEROUGE2></JAUNEROUGE2>
                            <ROUGE></ROUGE>
                            <MOTIF></MOTIF>
                        </CARTON7>
                        <CARTON8>
                            <NOM></NOM>
                            <ASSOCIATION></ASSOCIATION>
                            <JAUNE></JAUNE>
                            <JAUNEROUGE1></JAUNEROUGE1>
                            <JAUNEROUGE2></JAUNEROUGE2>
                            <ROUGE></ROUGE>
                            <MOTIF></MOTIF>
                        </CARTON8>
                        <CARTON9>
                            <NOM></NOM>
                            <ASSOCIATION></ASSOCIATION>
                            <JAUNE></JAUNE>
                            <JAUNEROUGE1></JAUNEROUGE1>
                            <JAUNEROUGE2></JAUNEROUGE2>
                            <ROUGE></ROUGE>
                            <MOTIF></MOTIF>
                        </CARTON9>
                        <CARTON10>
                            <NOM></NOM>
                            <ASSOCIATION></ASSOCIATION>
                            <JAUNE></JAUNE>
                            <JAUNEROUGE1></JAUNEROUGE1>
                            <JAUNEROUGE2></JAUNEROUGE2>
                            <ROUGE></ROUGE>
                            <MOTIF></MOTIF>
                        </CARTON10>
                    </cartons>
                    <reserves>
                        <RESERVE1>
                            <CODEGENRE></CODEGENRE>
                            <GENRE></GENRE>
                            <HEURE></HEURE>
                            <MINUTE></MINUTE>
                            <SCOREA></SCOREA>
                            <SCOREX></SCOREX>
                            <NOTE></NOTE>
                            <DEPOT></DEPOT>
                        </RESERVE1>
                        <RESERVE2>
                            <CODEGENRE></CODEGENRE>
                            <GENRE></GENRE>
                            <HEURE></HEURE>
                            <MINUTE></MINUTE>
                            <SCOREA></SCOREA>
                            <SCOREX></SCOREX>
                            <NOTE></NOTE>
                            <DEPOT></DEPOT>
                        </RESERVE2>
                        <RESERVE3>
                            <CODEGENRE></CODEGENRE>
                            <GENRE></GENRE>
                            <HEURE></HEURE>
                            <MINUTE></MINUTE>
                            <SCOREA></SCOREA>
                            <SCOREX></SCOREX>
                            <NOTE></NOTE>
                            <DEPOT></DEPOT>
                        </RESERVE3>
                        <RESERVE4>
                            <CODEGENRE></CODEGENRE>
                            <GENRE></GENRE>
                            <HEURE></HEURE>
                            <MINUTE></MINUTE>
                            <SCOREA></SCOREA>
                            <SCOREX></SCOREX>
                            <NOTE></NOTE>
                            <DEPOT></DEPOT>
                        </RESERVE4>
                    </reserves>
                    <arbitres />
                    <RAPPORTJA></RAPPORTJA>
                </verso>
            </liste>`;
    </script>
  </body>
</html>
